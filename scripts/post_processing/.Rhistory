library("tidyverse")
library("lme4")
library("MuMIn")
library("FSA")
library("PMCMRplus")
library("randomForest")
library("gbm")
library("diptest")
library("olsrr")
set.seed(1)
# Niche breadth
Levin.f <- read.csv("/Users/glmarschmann/.julia/dev/DEBmicroTrait/files/output/isolates_levins.csv") %>%
replace(is.na(.), 0.0)
Levin.f.std <- Levin.f[,1:83]/(apply(Levin.f[,1:83], 1, sum))
Levin.f.grouped <- BGE.f %>% group_by(isolate) %>% summarise(BGE_med = median(BGE), rgrowth_med = median(rgrowth))
Levin.f.grouped$levins <- levins(Levin.f.std)
#########################################################################################
# Levin's index
levins <- function(p_xi = ""){
p = 0
for (i in p_xi){
p = p + i^2
}
nb = 1 / (length(p_xi) * p)
return(nb)
}
# Niche breadth
Levin.f <- read.csv("/Users/glmarschmann/.julia/dev/DEBmicroTrait/files/output/isolates_levins.csv") %>%
replace(is.na(.), 0.0)
Levin.f.std <- Levin.f[,1:83]/(apply(Levin.f[,1:83], 1, sum))
Levin.f.grouped <- BGE.f %>% group_by(isolate) %>% summarise(BGE_med = median(BGE), rgrowth_med = median(rgrowth))
## Batch model BGE predictions
BGE.f <- read.csv("/Users/glmarschmann/.julia/dev/DEBmicroTrait/files/output/isolates_batch_model_BGE.csv") %>% filter(!is.nan(BGE))
Levin.f.grouped <- BGE.f %>% group_by(isolate) %>% summarise(BGE_med = median(BGE), rgrowth_med = median(rgrowth))
Levin.f.grouped$levins <- levins(Levin.f.std)
Levin.f.grouped$response <- Levin.f$response
plot(Levin.f.grouped$levins, Levin.f.grouped$BGE_med)
m1 <- lm(log(BGE_med) ~ log(levins), data=Levin.f.grouped)
summary(m1)
View(Levin.f.grouped)
View(Levin.f)
View(Levin.f)
View(Levin.f.grouped)
Levin.f.grouped$response <- Levin.f$response
View(Levin.f.grouped)
Levin.f.grouped <- BGE.f %>% group_by(isolate, response) %>% summarise(BGE_med = median(BGE), rgrowth_med = median(rgrowth))
View(Levin.f.grouped)
Levin.f.grouped$levins <- levins(Levin.f.std)
plot(Levin.f.grouped$levins, Levin.f.grouped$BGE_med)
m1 <- lm(log(BGE_med) ~ log(levins), data=Levin.f.grouped)
summary(m1)
plot(density(Levin.f.grouped$BGE_med))
dip.test(Levin.f.grouped$levins, simulate=TRUE, B=5000)
Levin.f.grouped.neg <- Levin.f.grouped %>% filter(response=="negative")
plot(Levin.f.grouped.neg$levins, Levin.f.grouped.neg$BGE_med)
m1 <- lm(log(BGE_med) ~ log(levins), data=Levin.f.grouped.neg)
summary(m1)
Levin.f.grouped.pos <- Levin.f.grouped %>% filter(response=="positive")
plot(Levin.f.grouped.pos$levins, Levin.f.grouped.pos$BGE_med)
m1 <- lm(log(BGE_med) ~ log(levins), data=Levin.f.grouped.pos)
summary(m1)
Levin.f.grouped.und <- Levin.f.grouped %>% filter(response=="undefined")
plot(Levin.f.grouped.und$levins, Levin.f.grouped.und$BGE_med)
m1 <- lm(log(BGE_med) ~ log(levins), data=Levin.f.grouped.und)
summary(m1)
Levin.f.grouped.pos <- Levin.f.grouped %>% filter(response=="positive")
plot(Levin.f.grouped.pos$levins, Levin.f.grouped.pos$BGE_med)
m1 <- lm(log(BGE_med) ~ log(levins), data=Levin.f.grouped.pos)
summary(m1)
Levin.f.grouped.und <- Levin.f.grouped %>% filter(response=="undefined")
plot(Levin.f.grouped.und$levins, Levin.f.grouped.und$BGE_med)
m1 <- lm(log(BGE_med) ~ log(levins), data=Levin.f.grouped.und)
summary(m1)
Levin.f.grouped.neg <- Levin.f.grouped %>% filter(response=="negative")
plot(Levin.f.grouped.neg$levins, Levin.f.grouped.neg$BGE_med)
m1 <- lm(log(BGE_med) ~ log(levins), data=Levin.f.grouped.neg)
summary(m1)
Levin.f.grouped.pos <- Levin.f.grouped %>% filter(response=="positive")
plot(Levin.f.grouped.pos$levins, Levin.f.grouped.pos$BGE_med)
m1 <- lm(log(BGE_med) ~ log(levins), data=Levin.f.grouped.pos)
summary(m1)
